<mvc:View controllerName="com.pontual.cmm.controller.OperacaoOrdem"
    height="100%"
    xmlns:mvc="sap.ui.core.mvc" 
	xmlns:l="sap.ui.layout"
	xmlns:f="sap.ui.layout.form"
	xmlns:core="sap.ui.core"    
    displayBlock="true"
    xmlns="sap.m">
    <Page id="pageOperacaoOrdem" 
          title="{i18n>title}" 
          titleAlignment="Center"
          showNavButton="true"   
		  navButtonPress="onNavBack"       
          class="sapUiContentPadding sapUiResponsivePadding--header sapUiResponsivePadding--subHeader sapUiResponsivePadding--content sapUiResponsivePadding--footer">
        <headerContent>
            <ObjectStatus
                id="networkStatus"
                active="false"
                inverted="true"
                icon="{path: 'conexaoModel>statusConexao',
                    formatter: 'com.pontual.cmm.model.formatter.getIconeConexao'}"
                state="{path: 'conexaoModel>statusConexao',
                        formatter: 'com.pontual.cmm.model.formatter.getCorIconeConexao'}"
            />
        </headerContent>       
		<content>
            <VBox class="sapUiSmallMargin">     
				<f:Form id="dadosGeraisForm"
				editable="true">
				<f:title>
					<core:Title text="{i18n>ordem}" />
				</f:title>
				<f:layout>
					<f:ResponsiveGridLayout
						labelSpanXL="4"
						labelSpanL="4"
						labelSpanM="12"
						labelSpanS="12"
						adjustLabelSpan="false"
						emptySpanXL="0"
						emptySpanL="0"
						emptySpanM="0"
						emptySpanS="0"
						columnsXL="2"
						columnsL="2"
						columnsM="2"
						singleContainerFullSize="false" />
				</f:layout>
				<f:formContainers>
					<f:FormContainer title="">
						<f:formElements>
							<f:FormElement label="{i18n>equipamento}">
								<f:fields>
									<Text text="{operacoesOrdemModel>Codequip}" />
								</f:fields>
							</f:FormElement>
							<f:FormElement label="">
								<f:fields>
									<Text text="{operacoesOrdemModel>DesEqui}" />
								</f:fields>
							</f:FormElement>							
							<f:FormElement label="{i18n>ordem}">
								<f:fields>
									<Text text="{operacoesOrdemModel>Ordem} - {operacoesOrdemModel>Descratividade}"  />
								</f:fields>
							</f:FormElement>								
						</f:formElements>
					</f:FormContainer>	
					<f:FormContainer title="">
						<f:formElements>							
							<f:FormElement label="{i18n>plano}">
								<f:fields>
									<Text text="{operacoesOrdemModel>DescricaoOrd}" />
								</f:fields>
							</f:FormElement>							
							<f:FormElement label="{i18n>ciclo}">
								<f:fields>
									<Text text="{operacoesOrdemModel>Ciclo}" />
								</f:fields>
							</f:FormElement>
						</f:formElements>
					</f:FormContainer>									
				</f:formContainers>
			</f:Form>
	</VBox>
	<VBox class="sapUiSmallMargin">    	 
		<Table id="idOperacoesTable" 
				alternateRowColors="true"
				autoPopinMode="false" 
				contextualWidth="Auto"		
				growing="true" 
				growingThreshold="100" 
				paste="onPaste" 
				items="{operacoesOrdemModel>operacoes}">
			<headerToolbar>
				<OverflowToolbar id="otbSubheader">
					<Title text="{i18n>operacoes}" level="H2" />
					<ToolbarSpacer />
				</OverflowToolbar>
			</headerToolbar>
			<columns>
				<Column hAlign="Begin" minScreenWidth="Phone" demandPopin="true" width="50%">
					<Text text="{i18n>operacoes}" />
				</Column>
				<Column hAlign="Center" vAlign="Middle" minScreenWidth="Tablet" demandPopin="true" width="12.5%">
					<Text text="{i18n>confirmado}" />
				</Column>
				<Column hAlign="Center" vAlign="Middle" minScreenWidth="Tablet" demandPopin="true" width="12.5%">
					<Text text="{i18n>pendente}" />
				</Column>
				<Column hAlign="Center" vAlign="Middle" minScreenWidth="Tablet" demandPopin="true" width="12.5%">
					<Text text="{i18n>naoconfirmado}" />
				</Column>								
				<Column hAlign="Center" vAlign="Middle" minScreenWidth="Tablet" demandPopin="true" width="12.5%">
					<Text text="{i18n>textolongo}" />
				</Column>																			
			</columns>
			<items>
				<ColumnListItem vAlign="Middle">
					<cells>
						<ObjectIdentifier title="{operacoesOrdemModel>Operacao}" text="{operacoesOrdemModel>Descricao}"/>
						<Button type="{path: 'operacoesOrdemModel>Status',
							formatter: 'com.pontual.cmm.model.formatter.getToggleConfirmado'}" press="onPressConfirmado" icon="sap-icon://status-positive"  enabled="{= !${operacoesOrdemModel>Sincronizada} }"></Button>  
						<Button type="{path: 'operacoesOrdemModel>Status',
							formatter: 'com.pontual.cmm.model.formatter.getTogglePendente'}" press="onPressPendente" icon="sap-icon://status-critical" enabled="{= !${operacoesOrdemModel>Sincronizada} }"></Button>   	
						<Button type="{path: 'operacoesOrdemModel>Status',
							formatter: 'com.pontual.cmm.model.formatter.getToggleNaoConfirmado'}" press="onPressNaoConfirmado" icon="sap-icon://status-error"  enabled="{= !${operacoesOrdemModel>Sincronizada} }"></Button>  																			
						<Button	tooltip="{i18n>textolongo}" icon="sap-icon://detail-view" press="onDialogTextoInfo"  visible="{= ${operacoesOrdemModel>Texto} ? true : false }" />
					</cells>
				</ColumnListItem>
			</items>
		</Table>
	</VBox>	
		</content>
		<footer>
			<OverflowToolbar>
				<!-- <Button id="MessagePopoverBtn"
					visible="{=!!${message>/}.length}"
					icon="{ path: '/', formatter: '.buttonIconFormatter' }"
					type="{ path: '/', formatter: '.buttonTypeFormatter' }"
					text= "{path: '/', formatter: '.highestSeverityMessages' }"
					press=".handleMessagePopoverPress"
					ariaHasPopup="Dialog"/> -->
				<ToolbarSpacer/>
				<Button id="criarOrdem2Button" text="{i18n>criarordem}" type="Emphasized" press="onCriarOrdem" icon="sap-icon://add-activity" ></Button>        
                <Button id="finalizarOperacoesButton" text="{i18n>finalizaroperacao}" type="Success" press="onFinalizarOperacao" icon="sap-icon://wrench" enabled="{= ${layoutTelaModel>/FinalizarOperacoes} }" ></Button>
				<!-- <Button id="finalizarOrdensButton" text="{i18n>finalizarordem}" type="Attention" press="onCancelarComboio" icon="sap-icon://eam-work-order" enabled="true" visible="{= ${layoutTelaModel>/FinalizarOrdemVisible} }" ></Button>    -->             
				<Button id="finalizarOrdensButton" text="{i18n>finalizarordem}" type="Attention" press="onFinalizarOrdem" icon="sap-icon://eam-work-order" enabled="{= ${layoutTelaModel>/FinalizarOrdemEnable} }"  visible="{= ${layoutTelaModel>/FinalizarOrdemVisible} }" ></Button>                
			</OverflowToolbar>
		</footer>
    </Page>
	<Dialog id="DialogTextoInfo"
        title="Texto"
        type="Message"
        afterClose="onCloseDialog"
        class="sapUiResponsivePadding">
		<content>
			<Text id="TextoInfo" text="" renderWhitespace="true" 
    wrapping="true" />
		</content>
		<beginButton>
			<Button text="OK" press="onCloseDialog" />
		</beginButton>
	</Dialog>

</mvc:View>
